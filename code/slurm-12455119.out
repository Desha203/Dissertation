Defaulting to user installation because normal site-packages is not writeable
Looking in indexes: https://pypi.org/simple, https://pypi.ngc.nvidia.com
Requirement already satisfied: segmentation-models-3D in /user/home/rb21991/.local/lib/python3.12/site-packages (1.1.1)
Requirement already satisfied: keras==3.3.3 in /user/home/rb21991/.local/lib/python3.12/site-packages (from segmentation-models-3D) (3.3.3)
Requirement already satisfied: classification-models-3D==1.1.0 in /user/home/rb21991/.local/lib/python3.12/site-packages (from segmentation-models-3D) (1.1.0)
Requirement already satisfied: absl-py in /user/home/rb21991/.local/lib/python3.12/site-packages (from keras==3.3.3->segmentation-models-3D) (2.2.2)
Requirement already satisfied: numpy in /user/home/rb21991/.local/lib/python3.12/site-packages (from keras==3.3.3->segmentation-models-3D) (1.26.4)
Requirement already satisfied: rich in /user/home/rb21991/.local/lib/python3.12/site-packages (from keras==3.3.3->segmentation-models-3D) (14.0.0)
Requirement already satisfied: namex in /user/home/rb21991/.local/lib/python3.12/site-packages (from keras==3.3.3->segmentation-models-3D) (0.0.9)
Requirement already satisfied: h5py in /software/local/languages/miniforge3/envs/tensorflow/lib/python3.12/site-packages (from keras==3.3.3->segmentation-models-3D) (3.11.0)
Requirement already satisfied: optree in /user/home/rb21991/.local/lib/python3.12/site-packages (from keras==3.3.3->segmentation-models-3D) (0.15.0)
Requirement already satisfied: ml-dtypes in /user/home/rb21991/.local/lib/python3.12/site-packages (from keras==3.3.3->segmentation-models-3D) (0.5.1)
Requirement already satisfied: typing-extensions>=4.5.0 in /software/local/languages/miniforge3/envs/tensorflow/lib/python3.12/site-packages (from optree->keras==3.3.3->segmentation-models-3D) (4.12.2)
Requirement already satisfied: markdown-it-py>=2.2.0 in /user/home/rb21991/.local/lib/python3.12/site-packages (from rich->keras==3.3.3->segmentation-models-3D) (3.0.0)
Requirement already satisfied: pygments<3.0.0,>=2.13.0 in /software/local/languages/miniforge3/envs/tensorflow/lib/python3.12/site-packages (from rich->keras==3.3.3->segmentation-models-3D) (2.18.0)
Requirement already satisfied: mdurl~=0.1 in /user/home/rb21991/.local/lib/python3.12/site-packages (from markdown-it-py>=2.2.0->rich->keras==3.3.3->segmentation-models-3D) (0.1.2)
Defaulting to user installation because normal site-packages is not writeable
Looking in indexes: https://pypi.org/simple, https://pypi.ngc.nvidia.com
Requirement already satisfied: albumentations in /user/home/rb21991/.local/lib/python3.12/site-packages (2.0.8)
Requirement already satisfied: numpy>=1.24.4 in /user/home/rb21991/.local/lib/python3.12/site-packages (from albumentations) (1.26.4)
Requirement already satisfied: scipy>=1.10.0 in /software/local/languages/miniforge3/envs/tensorflow/lib/python3.12/site-packages (from albumentations) (1.13.1)
Requirement already satisfied: PyYAML in /software/local/languages/miniforge3/envs/tensorflow/lib/python3.12/site-packages (from albumentations) (6.0.1)
Requirement already satisfied: pydantic>=2.9.2 in /user/home/rb21991/.local/lib/python3.12/site-packages (from albumentations) (2.11.7)
Requirement already satisfied: albucore==0.0.24 in /user/home/rb21991/.local/lib/python3.12/site-packages (from albumentations) (0.0.24)
Requirement already satisfied: opencv-python-headless>=4.9.0.80 in /user/home/rb21991/.local/lib/python3.12/site-packages (from albumentations) (4.12.0.88)
Requirement already satisfied: stringzilla>=3.10.4 in /user/home/rb21991/.local/lib/python3.12/site-packages (from albucore==0.0.24->albumentations) (3.12.5)
Requirement already satisfied: simsimd>=5.9.2 in /user/home/rb21991/.local/lib/python3.12/site-packages (from albucore==0.0.24->albumentations) (6.5.0)
Collecting numpy>=1.24.4 (from albumentations)
  Downloading numpy-2.2.6-cp312-cp312-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (62 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 62.0/62.0 kB 58.9 MB/s eta 0:00:00
Requirement already satisfied: annotated-types>=0.6.0 in /user/home/rb21991/.local/lib/python3.12/site-packages (from pydantic>=2.9.2->albumentations) (0.7.0)
Requirement already satisfied: pydantic-core==2.33.2 in /user/home/rb21991/.local/lib/python3.12/site-packages (from pydantic>=2.9.2->albumentations) (2.33.2)
Requirement already satisfied: typing-extensions>=4.12.2 in /software/local/languages/miniforge3/envs/tensorflow/lib/python3.12/site-packages (from pydantic>=2.9.2->albumentations) (4.12.2)
Requirement already satisfied: typing-inspection>=0.4.0 in /user/home/rb21991/.local/lib/python3.12/site-packages (from pydantic>=2.9.2->albumentations) (0.4.1)
Downloading numpy-2.2.6-cp312-cp312-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (16.5 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 16.5/16.5 MB 118.2 MB/s eta 0:00:00
Installing collected packages: numpy
  Attempting uninstall: numpy
    Found existing installation: numpy 1.26.4
    Uninstalling numpy-1.26.4:
      Successfully uninstalled numpy-1.26.4
ERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.
tensorflow 2.16.1 requires ml-dtypes~=0.3.1, but you have ml-dtypes 0.5.1 which is incompatible.
tensorflow 2.16.1 requires tensorboard<2.17,>=2.16, but you have tensorboard 2.19.0 which is incompatible.
Successfully installed numpy-2.2.6
Defaulting to user installation because normal site-packages is not writeable
Looking in indexes: https://pypi.org/simple, https://pypi.ngc.nvidia.com
Collecting numpy<2.0
  Downloading numpy-1.26.4-cp312-cp312-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (61 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 61.0/61.0 kB 16.3 MB/s eta 0:00:00
Downloading numpy-1.26.4-cp312-cp312-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (18.0 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 18.0/18.0 MB 118.4 MB/s eta 0:00:00
Installing collected packages: numpy
  Attempting uninstall: numpy
    Found existing installation: numpy 2.2.6
    Uninstalling numpy-2.2.6:
      Successfully uninstalled numpy-2.2.6
ERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.
opencv-python-headless 4.12.0.88 requires numpy<2.3.0,>=2; python_version >= "3.9", but you have numpy 1.26.4 which is incompatible.
tensorflow 2.16.1 requires ml-dtypes~=0.3.1, but you have ml-dtypes 0.5.1 which is incompatible.
tensorflow 2.16.1 requires tensorboard<2.17,>=2.16, but you have tensorboard 2.19.0 which is incompatible.
Successfully installed numpy-1.26.4
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1754566275.125685 1410251 service.cc:145] XLA service 0x7f93bc0034f0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
I0000 00:00:1754566275.147165 1410251 service.cc:153]   StreamExecutor device (0): Tesla P100-PCIE-16GB, Compute Capability 6.0
I0000 00:00:1754566275.147183 1410251 service.cc:153]   StreamExecutor device (1): Tesla P100-PCIE-16GB, Compute Capability 6.0
2025-08-07 12:31:26.123140: E external/local_xla/xla/service/slow_operation_alarm.cc:65] Trying algorithm eng0{} for conv (f32[4,16,128,128,128]{4,3,2,1,0}, u8[0]{0}) custom-call(f32[4,16,128,128,128]{4,3,2,1,0}, f32[16,16,3,3,3]{4,3,2,1,0}, f32[16]{0}), window={size=3x3x3 pad=1_1x1_1x1_1}, dim_labels=bf012_oi012->bf012, custom_call_target="__cudnn$convBiasActivationForward", backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"cudnn_conv_backend_config":{"activation_mode":"kRelu","conv_result_scale":1,"side_input_scale":0,"leakyrelu_alpha":0}} is taking a while...
2025-08-07 12:31:26.636125: E external/local_xla/xla/service/slow_operation_alarm.cc:133] The operation took 1.513349878s
Trying algorithm eng0{} for conv (f32[4,16,128,128,128]{4,3,2,1,0}, u8[0]{0}) custom-call(f32[4,16,128,128,128]{4,3,2,1,0}, f32[16,16,3,3,3]{4,3,2,1,0}, f32[16]{0}), window={size=3x3x3 pad=1_1x1_1x1_1}, dim_labels=bf012_oi012->bf012, custom_call_target="__cudnn$convBiasActivationForward", backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"cudnn_conv_backend_config":{"activation_mode":"kRelu","conv_result_scale":1,"side_input_scale":0,"leakyrelu_alpha":0}} is taking a while...
2025-08-07 12:31:30.808126: E external/local_xla/xla/service/slow_operation_alarm.cc:65] Trying algorithm eng0{} for conv (f32[4,16,128,128,128]{4,3,2,1,0}, u8[0]{0}) custom-call(f32[4,32,128,128,128]{4,3,2,1,0}, f32[16,32,3,3,3]{4,3,2,1,0}, f32[16]{0}), window={size=3x3x3 pad=1_1x1_1x1_1}, dim_labels=bf012_oi012->bf012, custom_call_target="__cudnn$convBiasActivationForward", backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"cudnn_conv_backend_config":{"activation_mode":"kRelu","conv_result_scale":1,"side_input_scale":0,"leakyrelu_alpha":0}} is taking a while...
2025-08-07 12:31:32.821116: E external/local_xla/xla/service/slow_operation_alarm.cc:133] The operation took 3.013952737s
Trying algorithm eng0{} for conv (f32[4,16,128,128,128]{4,3,2,1,0}, u8[0]{0}) custom-call(f32[4,32,128,128,128]{4,3,2,1,0}, f32[16,32,3,3,3]{4,3,2,1,0}, f32[16]{0}), window={size=3x3x3 pad=1_1x1_1x1_1}, dim_labels=bf012_oi012->bf012, custom_call_target="__cudnn$convBiasActivationForward", backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"cudnn_conv_backend_config":{"activation_mode":"kRelu","conv_result_scale":1,"side_input_scale":0,"leakyrelu_alpha":0}} is taking a while...
2025-08-07 12:31:42.461127: E external/local_xla/xla/service/slow_operation_alarm.cc:65] Trying algorithm eng20{k2=6,k3=0} for conv (f32[16,3,3,3,3]{4,3,2,1,0}, u8[0]{0}) custom-call(f32[4,3,128,128,128]{4,3,2,1,0}, f32[4,16,128,128,128]{4,3,2,1,0}), window={size=3x3x3 pad=1_1x1_1x1_1}, dim_labels=bf012_oi012->bf012, custom_call_target="__cudnn$convBackwardFilter", backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"cudnn_conv_backend_config":{"activation_mode":"kNone","conv_result_scale":1,"side_input_scale":0,"leakyrelu_alpha":0}} is taking a while...
2025-08-07 12:31:42.471498: E external/local_xla/xla/service/slow_operation_alarm.cc:133] The operation took 1.015211649s
Trying algorithm eng20{k2=6,k3=0} for conv (f32[16,3,3,3,3]{4,3,2,1,0}, u8[0]{0}) custom-call(f32[4,3,128,128,128]{4,3,2,1,0}, f32[4,16,128,128,128]{4,3,2,1,0}), window={size=3x3x3 pad=1_1x1_1x1_1}, dim_labels=bf012_oi012->bf012, custom_call_target="__cudnn$convBackwardFilter", backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"cudnn_conv_backend_config":{"activation_mode":"kNone","conv_result_scale":1,"side_input_scale":0,"leakyrelu_alpha":0}} is taking a while...
2025-08-07 12:31:45.706129: E external/local_xla/xla/service/slow_operation_alarm.cc:65] Trying algorithm eng20{k2=6,k3=0} for conv (f32[16,16,3,3,3]{4,3,2,1,0}, u8[0]{0}) custom-call(f32[4,16,128,128,128]{4,3,2,1,0}, f32[4,16,128,128,128]{4,3,2,1,0}), window={size=3x3x3 pad=1_1x1_1x1_1}, dim_labels=bf012_oi012->bf012, custom_call_target="__cudnn$convBackwardFilter", backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"cudnn_conv_backend_config":{"activation_mode":"kNone","conv_result_scale":1,"side_input_scale":0,"leakyrelu_alpha":0}} is taking a while...
2025-08-07 12:31:45.718005: E external/local_xla/xla/service/slow_operation_alarm.cc:133] The operation took 1.012763786s
Trying algorithm eng20{k2=6,k3=0} for conv (f32[16,16,3,3,3]{4,3,2,1,0}, u8[0]{0}) custom-call(f32[4,16,128,128,128]{4,3,2,1,0}, f32[4,16,128,128,128]{4,3,2,1,0}), window={size=3x3x3 pad=1_1x1_1x1_1}, dim_labels=bf012_oi012->bf012, custom_call_target="__cudnn$convBackwardFilter", backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"cudnn_conv_backend_config":{"activation_mode":"kNone","conv_result_scale":1,"side_input_scale":0,"leakyrelu_alpha":0}} is taking a while...
2025-08-07 12:31:46.718118: E external/local_xla/xla/service/slow_operation_alarm.cc:65] Trying algorithm eng0{} for conv (f32[16,16,3,3,3]{4,3,2,1,0}, u8[0]{0}) custom-call(f32[4,16,128,128,128]{4,3,2,1,0}, f32[4,16,128,128,128]{4,3,2,1,0}), window={size=3x3x3 pad=1_1x1_1x1_1}, dim_labels=bf012_oi012->bf012, custom_call_target="__cudnn$convBackwardFilter", backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"cudnn_conv_backend_config":{"activation_mode":"kNone","conv_result_scale":1,"side_input_scale":0,"leakyrelu_alpha":0}} is taking a while...
2025-08-07 12:31:49.178680: E external/local_xla/xla/service/slow_operation_alarm.cc:133] The operation took 3.46062151s
Trying algorithm eng0{} for conv (f32[16,16,3,3,3]{4,3,2,1,0}, u8[0]{0}) custom-call(f32[4,16,128,128,128]{4,3,2,1,0}, f32[4,16,128,128,128]{4,3,2,1,0}), window={size=3x3x3 pad=1_1x1_1x1_1}, dim_labels=bf012_oi012->bf012, custom_call_target="__cudnn$convBackwardFilter", backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"cudnn_conv_backend_config":{"activation_mode":"kNone","conv_result_scale":1,"side_input_scale":0,"leakyrelu_alpha":0}} is taking a while...
2025-08-07 12:31:52.121118: E external/local_xla/xla/service/slow_operation_alarm.cc:65] Trying algorithm eng0{} for conv (f32[32,32,3,3,3]{4,3,2,1,0}, u8[0]{0}) custom-call(f32[4,32,64,64,64]{4,3,2,1,0}, f32[4,32,64,64,64]{4,3,2,1,0}), window={size=3x3x3 pad=1_1x1_1x1_1}, dim_labels=bf012_oi012->bf012, custom_call_target="__cudnn$convBackwardFilter", backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"cudnn_conv_backend_config":{"activation_mode":"kNone","conv_result_scale":1,"side_input_scale":0,"leakyrelu_alpha":0}} is taking a while...
2025-08-07 12:31:52.780224: E external/local_xla/xla/service/slow_operation_alarm.cc:133] The operation took 1.659992627s
Trying algorithm eng0{} for conv (f32[32,32,3,3,3]{4,3,2,1,0}, u8[0]{0}) custom-call(f32[4,32,64,64,64]{4,3,2,1,0}, f32[4,32,64,64,64]{4,3,2,1,0}), window={size=3x3x3 pad=1_1x1_1x1_1}, dim_labels=bf012_oi012->bf012, custom_call_target="__cudnn$convBackwardFilter", backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"cudnn_conv_backend_config":{"activation_mode":"kNone","conv_result_scale":1,"side_input_scale":0,"leakyrelu_alpha":0}} is taking a while...
2025-08-07 12:32:00.074133: E external/local_xla/xla/service/slow_operation_alarm.cc:65] Trying algorithm eng20{k2=6,k3=0} for conv (f32[16,32,3,3,3]{4,3,2,1,0}, u8[0]{0}) custom-call(f32[4,32,128,128,128]{4,3,2,1,0}, f32[4,16,128,128,128]{4,3,2,1,0}), window={size=3x3x3 pad=1_1x1_1x1_1}, dim_labels=bf012_oi012->bf012, custom_call_target="__cudnn$convBackwardFilter", backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"cudnn_conv_backend_config":{"activation_mode":"kNone","conv_result_scale":1,"side_input_scale":0,"leakyrelu_alpha":0}} is taking a while...
2025-08-07 12:32:00.208081: E external/local_xla/xla/service/slow_operation_alarm.cc:133] The operation took 1.141837597s
Trying algorithm eng20{k2=6,k3=0} for conv (f32[16,32,3,3,3]{4,3,2,1,0}, u8[0]{0}) custom-call(f32[4,32,128,128,128]{4,3,2,1,0}, f32[4,16,128,128,128]{4,3,2,1,0}), window={size=3x3x3 pad=1_1x1_1x1_1}, dim_labels=bf012_oi012->bf012, custom_call_target="__cudnn$convBackwardFilter", backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"cudnn_conv_backend_config":{"activation_mode":"kNone","conv_result_scale":1,"side_input_scale":0,"leakyrelu_alpha":0}} is taking a while...
2025-08-07 12:32:01.208204: E external/local_xla/xla/service/slow_operation_alarm.cc:65] Trying algorithm eng0{} for conv (f32[16,32,3,3,3]{4,3,2,1,0}, u8[0]{0}) custom-call(f32[4,32,128,128,128]{4,3,2,1,0}, f32[4,16,128,128,128]{4,3,2,1,0}), window={size=3x3x3 pad=1_1x1_1x1_1}, dim_labels=bf012_oi012->bf012, custom_call_target="__cudnn$convBackwardFilter", backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"cudnn_conv_backend_config":{"activation_mode":"kNone","conv_result_scale":1,"side_input_scale":0,"leakyrelu_alpha":0}} is taking a while...
2025-08-07 12:32:06.894176: E external/local_xla/xla/service/slow_operation_alarm.cc:133] The operation took 6.686022748s
Trying algorithm eng0{} for conv (f32[16,32,3,3,3]{4,3,2,1,0}, u8[0]{0}) custom-call(f32[4,32,128,128,128]{4,3,2,1,0}, f32[4,16,128,128,128]{4,3,2,1,0}), window={size=3x3x3 pad=1_1x1_1x1_1}, dim_labels=bf012_oi012->bf012, custom_call_target="__cudnn$convBackwardFilter", backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"cudnn_conv_backend_config":{"activation_mode":"kNone","conv_result_scale":1,"side_input_scale":0,"leakyrelu_alpha":0}} is taking a while...
I0000 00:00:1754566334.889352 1410251 device_compiler.h:188] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
Images shape: (128, 128, 128, 4)
Masks shape: (128, 128, 128, 4)
Example Proccessed data set:
(None, 128, 128, 128, 3)
(None, 128, 128, 128, 4)
Found 117 patient folders.
Warning: mask.npy not found for patient UPENN-GBM-00013_11
Warning: mask.npy not found for patient UPENN-GBM-00102_11
Warning: mask.npy not found for patient UPENN-GBM-00106_11
Warning: mask.npy not found for patient UPENN-GBM-00115_11
Warning: mask.npy not found for patient UPENN-GBM-00174_11
Warning: mask.npy not found for patient UPENN-GBM-00192_11
Warning: mask.npy not found for patient UPENN-GBM-00201_11
Warning: mask.npy not found for patient UPENN-GBM-00290_11
Warning: mask.npy not found for patient UPENN-GBM-00307_11
Warning: mask.npy not found for patient UPENN-GBM-00380_11
Warning: mask.npy not found for patient UPENN-GBM-00393_11
0
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
Class weights: 0.26 41.71 9.93 31.5
Num GPUs Available: 2
Warning: mask.npy not found for training patient UPENN-GBM-00013_11
Warning: mask.npy not found for training patient UPENN-GBM-00102_11
Warning: mask.npy not found for training patient UPENN-GBM-00106_11
Warning: mask.npy not found for training patient UPENN-GBM-00115_11
Warning: mask.npy not found for training patient UPENN-GBM-00174_11
Warning: mask.npy not found for training patient UPENN-GBM-00192_11
Warning: mask.npy not found for training patient UPENN-GBM-00201_11
Warning: mask.npy not found for training patient UPENN-GBM-00290_11
Warning: mask.npy not found for training patient UPENN-GBM-00307_11
Warning: mask.npy not found for training patient UPENN-GBM-00380_11
Warning: mask.npy not found for training patient UPENN-GBM-00393_11
Warning: mask.npy not found for validation patient UPENN-GBM-00266_11
Warning: mask.npy not found for validation patient UPENN-GBM-00275_11
Segmentation Models: using `keras` framework.
Training model with modalities: [1, 2, 3]
Images shape: (4, 128, 128, 128, 3)
Masks shape: (4, 128, 128, 128, 4)
[1m 1/26[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m27:41[0m 66s/step - accuracy: 0.3399 - iou_score: 6.1913e-08 - loss: 1.0329[1m 2/26[0m [32m━[0m[37m━━━━━━━━━━━━━━━━━━━[0m [1m32s[0m 1s/step - accuracy: 0.4707 - iou_score: 4.5776e-04 - loss: 1.0293   [1m 3/26[0m [32m━━[0m[37m━━━━━━━━━━━━━━━━━━[0m [1m35s[0m 2s/step - accuracy: 0.5444 - iou_score: 0.0220 - loss: 1.0264    [1m 4/26[0m [32m━━━[0m[37m━━━━━━━━━━━━━━━━━[0m [1m36s[0m 2s/step - accuracy: 0.5981 - iou_score: 0.0372 - loss: 1.0237[1m 5/26[0m [32m━━━[0m[37m━━━━━━━━━━━━━━━━━[0m [1m35s[0m 2s/step - accuracy: 0.6385 - iou_score: 0.0487 - loss: 1.0215[1m 6/26[0m [32m━━━━[0m[37m━━━━━━━━━━━━━━━━[0m [1m33s[0m 2s/step - accuracy: 0.6696 - iou_score: 0.0583 - loss: 1.0196[1m 7/26[0m [32m━━━━━[0m[37m━━━━━━━━━━━━━━━[0m [1m31s[0m 2s/step - accuracy: 0.6947 - iou_score: 0.0669 - loss: 1.0180[1m 8/26[0m [32m━━━━━━[0m[37m━━━━━━━━━━━━━━[0m [1m30s[0m 2s/step - accuracy: 0.7151 - iou_score: 0.0745 - loss: 1.0167[1m 9/26[0m [32m━━━━━━[0m[37m━━━━━━━━━━━━━━[0m [1m28s[0m 2s/step - accuracy: 0.7322 - iou_score: 0.0813 - loss: 1.0154[1m10/26[0m [32m━━━━━━━[0m[37m━━━━━━━━━━━━━[0m [1m26s[0m 2s/step - accuracy: 0.7468 - iou_score: 0.0875 - loss: 1.0142[1m11/26[0m [32m━━━━━━━━[0m[37m━━━━━━━━━━━━[0m [1m25s[0m 2s/step - accuracy: 0.7595 - iou_score: 0.0932 - loss: 1.0131[1m12/26[0m [32m━━━━━━━━━[0m[37m━━━━━━━━━━━[0m [1m23s[0m 2s/step - accuracy: 0.7705 - iou_score: 0.0986 - loss: 1.0120[1m13/26[0m [32m━━━━━━━━━━[0m[37m━━━━━━━━━━[0m [1m22s[0m 2s/step - accuracy: 0.7803 - iou_score: 0.1036 - loss: 1.0110[1m14/26[0m [32m━━━━━━━━━━[0m[37m━━━━━━━━━━[0m [1m20s[0m 2s/step - accuracy: 0.7889 - iou_score: 0.1082 - loss: 1.0101[1m15/26[0m [32m━━━━━━━━━━━[0m[37m━━━━━━━━━[0m [1m18s[0m 2s/step - accuracy: 0.7967 - iou_score: 0.1124 - loss: 1.0092[1m16/26[0m [32m━━━━━━━━━━━━[0m[37m━━━━━━━━[0m [1m17s[0m 2s/step - accuracy: 0.8036 - iou_score: 0.1164 - loss: 1.0083[1m17/26[0m [32m━━━━━━━━━━━━━[0m[37m━━━━━━━[0m [1m15s[0m 2s/step - accuracy: 0.8100 - iou_score: 0.1202 - loss: 1.0075[1m18/26[0m [32m━━━━━━━━━━━━━[0m[37m━━━━━━━[0m [1m13s[0m 2s/step - accuracy: 0.8158 - iou_score: 0.1237 - loss: 1.0066[1m19/26[0m [32m━━━━━━━━━━━━━━[0m[37m━━━━━━[0m [1m12s[0m 2s/step - accuracy: 0.8212 - iou_score: 0.1270 - loss: 1.0059[1m20/26[0m [32m━━━━━━━━━━━━━━━[0m[37m━━━━━[0m [1m10s[0m 2s/step - accuracy: 0.8261 - iou_score: 0.1300 - loss: 1.0051[1m21/26[0m [32m━━━━━━━━━━━━━━━━[0m[37m━━━━[0m [1m8s[0m 2s/step - accuracy: 0.8306 - iou_score: 0.1328 - loss: 1.0044 [1m22/26[0m [32m━━━━━━━━━━━━━━━━[0m[37m━━━━[0m [1m6s[0m 2s/step - accuracy: 0.8348 - iou_score: 0.1355 - loss: 1.0037[1m23/26[0m [32m━━━━━━━━━━━━━━━━━[0m[37m━━━[0m [1m5s[0m 2s/step - accuracy: 0.8388 - iou_score: 0.1380 - loss: 1.0030[1m24/26[0m [32m━━━━━━━━━━━━━━━━━━[0m[37m━━[0m [1m3s[0m 2s/step - accuracy: 0.8425 - iou_score: 0.1404 - loss: 1.0023[1m25/26[0m [32m━━━━━━━━━━━━━━━━━━━[0m[37m━[0m [1m1s[0m 2s/step - accuracy: 0.8459 - iou_score: 0.1427 - loss: 1.00172025-08-07 12:33:10.573125: E external/local_xla/xla/service/slow_operation_alarm.cc:65] Trying algorithm eng0{} for conv (f32[2,16,128,128,128]{4,3,2,1,0}, u8[0]{0}) custom-call(f32[2,32,128,128,128]{4,3,2,1,0}, f32[16,32,3,3,3]{4,3,2,1,0}, f32[16]{0}), window={size=3x3x3 pad=1_1x1_1x1_1}, dim_labels=bf012_oi012->bf012, custom_call_target="__cudnn$convBiasActivationForward", backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"cudnn_conv_backend_config":{"activation_mode":"kRelu","conv_result_scale":1,"side_input_scale":0,"leakyrelu_alpha":0}} is taking a while...
2025-08-07 12:33:11.081364: E external/local_xla/xla/service/slow_operation_alarm.cc:133] The operation took 1.508363693s
Trying algorithm eng0{} for conv (f32[2,16,128,128,128]{4,3,2,1,0}, u8[0]{0}) custom-call(f32[2,32,128,128,128]{4,3,2,1,0}, f32[16,32,3,3,3]{4,3,2,1,0}, f32[16]{0}), window={size=3x3x3 pad=1_1x1_1x1_1}, dim_labels=bf012_oi012->bf012, custom_call_target="__cudnn$convBiasActivationForward", backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"cudnn_conv_backend_config":{"activation_mode":"kRelu","conv_result_scale":1,"side_input_scale":0,"leakyrelu_alpha":0}} is taking a while...
2025-08-07 12:33:16.838120: E external/local_xla/xla/service/slow_operation_alarm.cc:65] Trying algorithm eng20{k2=6,k3=0} for conv (f32[16,3,3,3,3]{4,3,2,1,0}, u8[0]{0}) custom-call(f32[2,3,128,128,128]{4,3,2,1,0}, f32[2,16,128,128,128]{4,3,2,1,0}), window={size=3x3x3 pad=1_1x1_1x1_1}, dim_labels=bf012_oi012->bf012, custom_call_target="__cudnn$convBackwardFilter", backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"cudnn_conv_backend_config":{"activation_mode":"kNone","conv_result_scale":1,"side_input_scale":0,"leakyrelu_alpha":0}} is taking a while...
2025-08-07 12:33:16.849815: E external/local_xla/xla/service/slow_operation_alarm.cc:133] The operation took 1.011965812s
Trying algorithm eng20{k2=6,k3=0} for conv (f32[16,3,3,3,3]{4,3,2,1,0}, u8[0]{0}) custom-call(f32[2,3,128,128,128]{4,3,2,1,0}, f32[2,16,128,128,128]{4,3,2,1,0}), window={size=3x3x3 pad=1_1x1_1x1_1}, dim_labels=bf012_oi012->bf012, custom_call_target="__cudnn$convBackwardFilter", backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"cudnn_conv_backend_config":{"activation_mode":"kNone","conv_result_scale":1,"side_input_scale":0,"leakyrelu_alpha":0}} is taking a while...
2025-08-07 12:33:19.163123: E external/local_xla/xla/service/slow_operation_alarm.cc:65] Trying algorithm eng20{k2=6,k3=0} for conv (f32[16,16,3,3,3]{4,3,2,1,0}, u8[0]{0}) custom-call(f32[2,16,128,128,128]{4,3,2,1,0}, f32[2,16,128,128,128]{4,3,2,1,0}), window={size=3x3x3 pad=1_1x1_1x1_1}, dim_labels=bf012_oi012->bf012, custom_call_target="__cudnn$convBackwardFilter", backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"cudnn_conv_backend_config":{"activation_mode":"kNone","conv_result_scale":1,"side_input_scale":0,"leakyrelu_alpha":0}} is taking a while...
2025-08-07 12:33:19.175414: E external/local_xla/xla/service/slow_operation_alarm.cc:133] The operation took 1.012399273s
Trying algorithm eng20{k2=6,k3=0} for conv (f32[16,16,3,3,3]{4,3,2,1,0}, u8[0]{0}) custom-call(f32[2,16,128,128,128]{4,3,2,1,0}, f32[2,16,128,128,128]{4,3,2,1,0}), window={size=3x3x3 pad=1_1x1_1x1_1}, dim_labels=bf012_oi012->bf012, custom_call_target="__cudnn$convBackwardFilter", backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"cudnn_conv_backend_config":{"activation_mode":"kNone","conv_result_scale":1,"side_input_scale":0,"leakyrelu_alpha":0}} is taking a while...
2025-08-07 12:33:20.176117: E external/local_xla/xla/service/slow_operation_alarm.cc:65] Trying algorithm eng0{} for conv (f32[16,16,3,3,3]{4,3,2,1,0}, u8[0]{0}) custom-call(f32[2,16,128,128,128]{4,3,2,1,0}, f32[2,16,128,128,128]{4,3,2,1,0}), window={size=3x3x3 pad=1_1x1_1x1_1}, dim_labels=bf012_oi012->bf012, custom_call_target="__cudnn$convBackwardFilter", backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"cudnn_conv_backend_config":{"activation_mode":"kNone","conv_result_scale":1,"side_input_scale":0,"leakyrelu_alpha":0}} is taking a while...
2025-08-07 12:33:20.905326: E external/local_xla/xla/service/slow_operation_alarm.cc:133] The operation took 1.729868863s
Trying algorithm eng0{} for conv (f32[16,16,3,3,3]{4,3,2,1,0}, u8[0]{0}) custom-call(f32[2,16,128,128,128]{4,3,2,1,0}, f32[2,16,128,128,128]{4,3,2,1,0}), window={size=3x3x3 pad=1_1x1_1x1_1}, dim_labels=bf012_oi012->bf012, custom_call_target="__cudnn$convBackwardFilter", backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"cudnn_conv_backend_config":{"activation_mode":"kNone","conv_result_scale":1,"side_input_scale":0,"leakyrelu_alpha":0}} is taking a while...
2025-08-07 12:33:29.287119: E external/local_xla/xla/service/slow_operation_alarm.cc:65] Trying algorithm eng20{k2=6,k3=0} for conv (f32[16,32,3,3,3]{4,3,2,1,0}, u8[0]{0}) custom-call(f32[2,32,128,128,128]{4,3,2,1,0}, f32[2,16,128,128,128]{4,3,2,1,0}), window={size=3x3x3 pad=1_1x1_1x1_1}, dim_labels=bf012_oi012->bf012, custom_call_target="__cudnn$convBackwardFilter", backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"cudnn_conv_backend_config":{"activation_mode":"kNone","conv_result_scale":1,"side_input_scale":0,"leakyrelu_alpha":0}} is taking a while...
2025-08-07 12:33:29.299197: E external/local_xla/xla/service/slow_operation_alarm.cc:133] The operation took 1.012257942s
Trying algorithm eng20{k2=6,k3=0} for conv (f32[16,32,3,3,3]{4,3,2,1,0}, u8[0]{0}) custom-call(f32[2,32,128,128,128]{4,3,2,1,0}, f32[2,16,128,128,128]{4,3,2,1,0}), window={size=3x3x3 pad=1_1x1_1x1_1}, dim_labels=bf012_oi012->bf012, custom_call_target="__cudnn$convBackwardFilter", backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"cudnn_conv_backend_config":{"activation_mode":"kNone","conv_result_scale":1,"side_input_scale":0,"leakyrelu_alpha":0}} is taking a while...
2025-08-07 12:33:30.299439: E external/local_xla/xla/service/slow_operation_alarm.cc:65] Trying algorithm eng0{} for conv (f32[16,32,3,3,3]{4,3,2,1,0}, u8[0]{0}) custom-call(f32[2,32,128,128,128]{4,3,2,1,0}, f32[2,16,128,128,128]{4,3,2,1,0}), window={size=3x3x3 pad=1_1x1_1x1_1}, dim_labels=bf012_oi012->bf012, custom_call_target="__cudnn$convBackwardFilter", backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"cudnn_conv_backend_config":{"activation_mode":"kNone","conv_result_scale":1,"side_input_scale":0,"leakyrelu_alpha":0}} is taking a while...
2025-08-07 12:33:32.645075: E external/local_xla/xla/service/slow_operation_alarm.cc:133] The operation took 3.34579814s
Trying algorithm eng0{} for conv (f32[16,32,3,3,3]{4,3,2,1,0}, u8[0]{0}) custom-call(f32[2,32,128,128,128]{4,3,2,1,0}, f32[2,16,128,128,128]{4,3,2,1,0}), window={size=3x3x3 pad=1_1x1_1x1_1}, dim_labels=bf012_oi012->bf012, custom_call_target="__cudnn$convBackwardFilter", backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"cudnn_conv_backend_config":{"activation_mode":"kNone","conv_result_scale":1,"side_input_scale":0,"leakyrelu_alpha":0}} is taking a while...
[1m26/26[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 3s/step - accuracy: 0.8491 - iou_score: 0.1449 - loss: 1.0011[1m26/26[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m160s[0m 4s/step - accuracy: 0.8521 - iou_score: 0.1469 - loss: 1.0005 - val_accuracy: 0.9564 - val_iou_score: 0.2403 - val_loss: 0.9667

Training finished.
Best Epoch (val_loss): 1
Training Duration: 160.69 seconds

Loading model: model_1_2_3.keras
Using modality indices: [1, 2, 3]
[1m1/1[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 4s/step[1m1/1[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m4s[0m 4s/step
[1m1/1[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 29ms/step[1m1/1[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 31ms/step
[1m1/1[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 30ms/step[1m1/1[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 30ms/step
[1m1/1[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 30ms/step[1m1/1[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 32ms/step
[1m1/1[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 41ms/step[1m1/1[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 41ms/step
[1m1/1[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 23ms/step[1m1/1[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 25ms/step
[1m1/1[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 23ms/step[1m1/1[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 23ms/step
[1m1/1[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 34ms/step[1m1/1[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 34ms/step
[1m1/1[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 23ms/step[1m1/1[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 25ms/step
[1m1/1[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 23ms/step[1m1/1[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 23ms/step
[1m1/1[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 54ms/step[1m1/1[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 56ms/step
[1m1/1[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 51ms/step[1m1/1[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 51ms/step
  Average Mean IoU: 0.2391
  Average Accuracy: 0.9564

Model with Best Average Mean IoU: model_1_2_3.keras with Average Mean IoU: 0.2391 and Average Accuracy: 0.9564
Model with Best Average Accuracy: model_1_2_3.keras with Average Accuracy: 0.9564 and Average Mean IoU: 0.2391

Loading model: model_1_2_3.keras
[1m1/1[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 604ms/step[1m1/1[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m1s[0m 606ms/step
Saved visualisation to: results/model_1_2_3_slice60.png
